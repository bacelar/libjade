require "curve25519.jinc"

export fn jade_scalarmult_curve25519_amd64_ref4(#transient reg u64 rp kp up) -> reg u64
{
  reg u64 r;
  #msf reg u64 ms;
  ms = #init_msf();
  ms = __curve25519_ref4(rp, kp, up, ms);
  ms = #init_msf();
  ?{}, r = #set0();
  return r;
}
